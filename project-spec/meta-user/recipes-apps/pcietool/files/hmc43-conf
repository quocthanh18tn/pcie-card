#!/bin/bash

if [ "$1" == "" ]; then
	echo "Missing device index. Syntax: $0 <index>"
	echo "Device list:"
	for file in /sys/bus/iio/devices/iio:device*/name; do 
		echo -n "$file --> " && cat "$file"
	done

	exit 1
fi

function write_n_read()
{
	TARGET="/sys/kernel/debug/iio/iio:device${1}/direct_reg_access"
	#Write to hmc
	echo $2 $3 > $TARGET;
	#Read from hmc
	echo $2 > $TARGET; echo -n 'Read back from 0x0:' ; cat $TARGET
}

write_n_read ${1} 0x0 0x0
write_n_read ${1} 0x1 0x40
write_n_read ${1} 0x2 0x0
write_n_read ${1} 0x3 0x34
write_n_read ${1} 0x4 0x7F
write_n_read ${1} 0x6 0x0
write_n_read ${1} 0x7 0x0
write_n_read ${1} 0xA 0x9
write_n_read ${1} 0xB 0x9
write_n_read ${1} 0x46 0x0
write_n_read ${1} 0x50 0xF
write_n_read ${1} 0x54 0x3
write_n_read ${1} 0x5A 0x1
write_n_read ${1} 0x5B 0x4
write_n_read ${1} 0x5C 0x0
write_n_read ${1} 0x5D 0x5
write_n_read ${1} 0x64 0x0
write_n_read ${1} 0x65 0x0
write_n_read ${1} 0x71 0x10
write_n_read ${1} 0x78 0x0
write_n_read ${1} 0x79 0x0
write_n_read ${1} 0x7A 0x0
write_n_read ${1} 0x7D 0x0
write_n_read ${1} 0x91 0x0
write_n_read ${1} 0x98 0x0
write_n_read ${1} 0x99 0x0
write_n_read ${1} 0x9A 0x0
write_n_read ${1} 0x9B 0xAA
write_n_read ${1} 0x9C 0xAA
write_n_read ${1} 0x9D 0xAA
write_n_read ${1} 0x9E 0xAA
write_n_read ${1} 0x9F 0x55
write_n_read ${1} 0xA0 0x56
write_n_read ${1} 0xA1 0x97
write_n_read ${1} 0xA2 0x3
write_n_read ${1} 0xA3 0x0
write_n_read ${1} 0xA4 0x0
write_n_read ${1} 0xAD 0x0
write_n_read ${1} 0xAE 0x8
write_n_read ${1} 0xAF 0x50
write_n_read ${1} 0xB0 0x9
write_n_read ${1} 0xB1 0xD
write_n_read ${1} 0xB2 0x0
write_n_read ${1} 0xB3 0x0
write_n_read ${1} 0xB5 0x0
write_n_read ${1} 0xB6 0x0
write_n_read ${1} 0xB7 0x0
write_n_read ${1} 0xB8 0x0
write_n_read ${1} 0xC8 0x72
write_n_read ${1} 0xC9 0x5
write_n_read ${1} 0xCA 0x0
write_n_read ${1} 0xCB 0x0
write_n_read ${1} 0xCC 0x0
write_n_read ${1} 0xCD 0x0
write_n_read ${1} 0xCE 0x0
write_n_read ${1} 0xCF 0x0
write_n_read ${1} 0xD0 0x91
write_n_read ${1} 0xD2 0x7C
write_n_read ${1} 0xD3 0x0
write_n_read ${1} 0xD4 0x5
write_n_read ${1} 0xD5 0x0
write_n_read ${1} 0xD6 0x0
write_n_read ${1} 0xD7 0x0
write_n_read ${1} 0xD8 0x0
write_n_read ${1} 0xD9 0x0
write_n_read ${1} 0xDA 0xB0
write_n_read ${1} 0xDC 0xF3
write_n_read ${1} 0xDD 0x5
write_n_read ${1} 0xDE 0x0
write_n_read ${1} 0xDF 0x0
write_n_read ${1} 0xE0 0x0
write_n_read ${1} 0xE1 0x0
write_n_read ${1} 0xE2 0x0
write_n_read ${1} 0xE3 0x0
write_n_read ${1} 0xE4 0x11
write_n_read ${1} 0xE6 0x7C
write_n_read ${1} 0xE7 0x0
write_n_read ${1} 0xE8 0x5
write_n_read ${1} 0xE9 0x0
write_n_read ${1} 0xEA 0x0
write_n_read ${1} 0xEB 0x0
write_n_read ${1} 0xEC 0x0
write_n_read ${1} 0xED 0x0
write_n_read ${1} 0xEE 0xB0
write_n_read ${1} 0xF0 0xF3
write_n_read ${1} 0xF1 0x5
write_n_read ${1} 0xF2 0x0
write_n_read ${1} 0xF3 0x0
write_n_read ${1} 0xF4 0x0
write_n_read ${1} 0xF5 0x0
write_n_read ${1} 0xF6 0x0
write_n_read ${1} 0xF7 0x0
write_n_read ${1} 0xF8 0x11
write_n_read ${1} 0xFA 0x7C
write_n_read ${1} 0xFB 0x0
write_n_read ${1} 0xFC 0x5
write_n_read ${1} 0xFD 0x0
write_n_read ${1} 0xFE 0x0
write_n_read ${1} 0xFF 0x0
write_n_read ${1} 0x100 0x0
write_n_read ${1} 0x101 0x0
write_n_read ${1} 0x102 0xB0
write_n_read ${1} 0x104 0xF3
write_n_read ${1} 0x105 0x5
write_n_read ${1} 0x106 0x0
write_n_read ${1} 0x107 0x0
write_n_read ${1} 0x108 0x0
write_n_read ${1} 0x109 0x0
write_n_read ${1} 0x10A 0x0
write_n_read ${1} 0x10B 0x0
write_n_read ${1} 0x10C 0x11
write_n_read ${1} 0x10E 0x7C
write_n_read ${1} 0x10F 0x0
write_n_read ${1} 0x110 0x5
write_n_read ${1} 0x111 0x0
write_n_read ${1} 0x112 0x0
write_n_read ${1} 0x113 0x0
write_n_read ${1} 0x114 0x0
write_n_read ${1} 0x115 0x0
write_n_read ${1} 0x116 0xB0
write_n_read ${1} 0x118 0xF3
write_n_read ${1} 0x119 0x5
write_n_read ${1} 0x11A 0x0
write_n_read ${1} 0x11B 0x0
write_n_read ${1} 0x11C 0x0
write_n_read ${1} 0x11D 0x0
write_n_read ${1} 0x11E 0x0
write_n_read ${1} 0x11F 0x0
write_n_read ${1} 0x120 0x11
write_n_read ${1} 0x122 0x7C
write_n_read ${1} 0x123 0x0
write_n_read ${1} 0x124 0x5
write_n_read ${1} 0x125 0x0
write_n_read ${1} 0x126 0x0
write_n_read ${1} 0x127 0x0
write_n_read ${1} 0x128 0x0
write_n_read ${1} 0x129 0x0
write_n_read ${1} 0x12A 0xB0
write_n_read ${1} 0x12C 0xF3
write_n_read ${1} 0x12D 0x5
write_n_read ${1} 0x12E 0x0
write_n_read ${1} 0x12F 0x0
write_n_read ${1} 0x130 0x0
write_n_read ${1} 0x131 0x0
write_n_read ${1} 0x132 0x0
write_n_read ${1} 0x133 0x0
write_n_read ${1} 0x134 0x11
write_n_read ${1} 0x136 0xFD
write_n_read ${1} 0x137 0x0
write_n_read ${1} 0x138 0x5
write_n_read ${1} 0x139 0x0
write_n_read ${1} 0x13A 0x0
write_n_read ${1} 0x13B 0x0
write_n_read ${1} 0x13C 0x0
write_n_read ${1} 0x13D 0x0
write_n_read ${1} 0x13E 0x30
write_n_read ${1} 0x140 0x72
write_n_read ${1} 0x141 0x5
write_n_read ${1} 0x142 0x0
write_n_read ${1} 0x143 0x0
write_n_read ${1} 0x144 0x0
write_n_read ${1} 0x145 0x0
write_n_read ${1} 0x146 0x0
write_n_read ${1} 0x147 0x0
write_n_read ${1} 0x148 0x91
write_n_read ${1} 0x14A 0x7C
write_n_read ${1} 0x14B 0x0
write_n_read ${1} 0x14C 0x5
write_n_read ${1} 0x14D 0x0
write_n_read ${1} 0x14E 0x0
write_n_read ${1} 0x14F 0x0
write_n_read ${1} 0x150 0x0
write_n_read ${1} 0x151 0x0
write_n_read ${1} 0x152 0xB0
write_n_read ${1} 0x001 0x02
write_n_read ${1} 0x001 0x00
